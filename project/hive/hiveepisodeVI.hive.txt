hive> CREATE TABLE episodeVI (name STRING, line STRING)ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' TBLPROPERTIES ("skip.header.line.count"="2");
OK
Time taken: 0.167 seconds
hive> LOAD DATA LOCAL INPATH '/episodeVI_dialouges.txt' INTO TABLE episodeVI;
Loading data to table default.episodevi
OK
Time taken: 0.962 seconds
hive> SELECT name,COUNT(name) AS no_of_lines from episodeVI GROUP BY name ORDER BY no_of_lines;
Query ID = root_20210915043357_cb675903-14da-4a97-a2ab-90266b07361f
Total jobs = 2
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1631675666497_0022, Tracking URL = http://133773e0be56:8088/proxy/application_1631675666497_0022/
Kill Command = /usr/local/hadoop/bin/mapred job  -kill job_1631675666497_0022
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 1
2021-09-15 04:34:16,714 Stage-1 map = 0%,  reduce = 0%
2021-09-15 04:34:26,498 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 6.03 sec
2021-09-15 04:34:37,189 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 11.53 sec
MapReduce Total cumulative CPU time: 11 seconds 530 msec
Ended Job = job_1631675666497_0022
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1631675666497_0023, Tracking URL = http://133773e0be56:8088/proxy/application_1631675666497_0023/
Kill Command = /usr/local/hadoop/bin/mapred job  -kill job_1631675666497_0023
Hadoop job information for Stage-2: number of mappers: 1; number of reducers: 1
2021-09-15 04:34:59,279 Stage-2 map = 0%,  reduce = 0%
2021-09-15 04:35:09,135 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 4.61 sec
2021-09-15 04:35:21,013 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 11.99 sec
MapReduce Total cumulative CPU time: 11 seconds 990 msec
Ended Job = job_1631675666497_0023
MapReduce Jobs Launched:
Stage-Stage-1: Map: 1  Reduce: 1   Cumulative CPU: 11.53 sec   HDFS Read: 55763 HDFS Write: 4792 SUCCESS
Stage-Stage-2: Map: 1  Reduce: 1   Cumulative CPU: 11.99 sec   HDFS Read: 12312 HDFS Write: 4253 SUCCESS
Total MapReduce CPU Time Spent: 23 seconds 520 msec
OK
YODA (tickled, chuckles)        1
YODA (shakes his head)  1
YODA (gathering all his strength)       1
Y-WING PILOT    1
WEDGE (VO)      1
WALKER PILOT #1 1
VOICE (OS)      1
VADER (turning to face him)     1
VADER (skeptical)       1
VADER (indicating lightsaber)   1
VADER (bows)    1
VADER (after a beat)    1
VADER (a whisper)       1
THREEPIO (to Wicket)    1
THREEPIO (to Artoo)     1
THREEPIO (still shaken) 1
THREEPIO (instantly)    1
THREEPIO (disappearing) 1
THREEPIO (cont) 1
STRANGE VOICE   1
STORMTROOPER (OS)       1
SECOND COMMANDER        1
SCOUT #l        1
SCOUT #2        1
SCOUT   1
RED TWO 1
RED THREE       1
RED LEADER (VO) 1
PILOT VOICE (HAN)(filtered)     1
PILOT #2        1
PILOT   1
PIETT (surprised)       1
PIETT (into comlink)    1
OPERATOR        1
OOLA    1
OFFICER 1
NINEDENINE (to a Gamorrean guard)       1
NAVIGATOR       1
MON MOTHMA (cont)       1
LURE    1
LUKE (with sadness)     1
LUKE (turning away, derisive)   1
LUKE (to Leia)  1
LUKE (shrugging it off) 1
LUKE (sarcastic)        1
LUKE (pointing to the controls) 1
LUKE (moving to his ship)       1
LUKE (indicating the one ahead) 1
LUKE (hesitant) 1
LUKE (groans)   1
LUKE (cont)     1
LUKE (concerned)        1
LEIA (to Han)   1
LEIA (softly)   1
LEIA (over comlink)     1
LEIA (into comlink)     1
LEIA (alarmed)  1
LANDO (to himself)      1
LANDO (smiling) 1
LANDO (over comlink)    1
LANDO (into comlink)    1
LANDO (desperately)     1
JERJERROD (aghast)      1
JABBA (cont Huttese subtitled)  1
HAN/PILOT (VO)  1
HAN and LUKE    1
HAN (with self-confident grin)  1
HAN (whispering to himself)     1
HAN (turning to Luke)   1
HAN (to Luke)   1
HAN (to Leia)   1
HAN (smiles)    1
HAN (sighs)     1
HAN (sarcastic) 1
HAN (over comlink)      1
HAN (loses his temper)  1
HAN (looks at him warmly)       1
HAN (grins)     1
HAN (gravely)   1
HAN (chuckles)  1
HAN (blinking)  1
HAN (angry)     1
HAN (OS)        1
GREEN LEADER    1
GRAY LEADER     1
EMPEROR (very cool)     1
EMPEROR (to Vader)      1
EMPEROR (to Luke)       1
EMPEROR (no surprise)   1
EMPEROR (laughs)        1
EMPEROR (laughing)      1
EMPEROR (cont)  1
EMPEROR (angry) 1
DEATH STAR CONTROLLER(filtered VO)      1
CONTROLLER (filtered)   1
CONTROL ROOM COMMANDER  1
BUNKER COMMANDER        1
BIB (in Huttese subtitled)      1
BEN (grinning at Luke's indignation)    1
BEN (continuing his narrative)  1
BEN (attempting to give solace with his words)  1
BEN (OS)        1
ANAKIN (very weak)      1
ANAKIN  1
ACKBAR (cont)   1
GENERAL MADINE  2
CONTROLLER (over radio) 2
ACKBAR (VO)     2
BOUSHH (in Ubese subtitled)     2
CONTROLLER      2
MON MOTHMA      2
GUARD   2
SHUTTLE CAPTAIN 2
SCOUT #1        2
HAN (cont)      3
REBEL PILOT     3
JABBA   4
BIB     5
BOUSHH  5
NINEDENINE      5
STORMTROOPER    5
JERJERROD       6
PIETT   6
COMMANDER       7
YODA    10
WEDGE   10
ACKBAR  11
BEN     14
JABBA (in Huttese subtitled)    15
EMPEROR 31
LANDO   35
VADER   37
LEIA    51
THREEPIO        84
LUKE    100
HAN     104
Time taken: 85.5 seconds, Fetched: 136 row(s)

EXPORT:

hive> INSERT OVERWRITE DIRECTORY '/user/root/output/exportVI'
    > ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
    > SELECT * FROM episodeVI;
Query ID = root_20210915045252_f47cba84-472f-4da9-b83e-87769dba10a9
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1631675666497_0026, Tracking URL = http://133773e0be56:8088/proxy/application_1631675666497_0026/
Kill Command = /usr/local/hadoop/bin/mapred job  -kill job_1631675666497_0026
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2021-09-15 04:53:11,989 Stage-1 map = 0%,  reduce = 0%
2021-09-15 04:53:23,915 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 5.32 sec
MapReduce Total cumulative CPU time: 5 seconds 320 msec
Ended Job = job_1631675666497_0026
Stage-3 is selected by condition resolver.
Stage-2 is filtered out by condition resolver.
Stage-4 is filtered out by condition resolver.
Moving data to directory hdfs://133773e0be56:9000/user/root/output/exportVI/.hive-staging_hive_2021-09-15_04-52-52_506_2058605155387271736-1/-ext-10000
Moving data to directory /user/root/output/exportVI
MapReduce Jobs Launched:
Stage-Stage-1: Map: 1   Cumulative CPU: 5.32 sec   HDFS Read: 48360 HDFS Write: 43615 SUCCESS
Total MapReduce CPU Time Spent: 5 seconds 320 msec
OK
Time taken: 32.753 seconds


root@133773e0be56:/# hdfs dfs -ls /user/root/output/exportVI
Found 1 items
-rw-r--r--   1 root supergroup      43615 2021-09-15 04:53 /user/root/output/exportVI/000000_0